<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMMOTION.APP - Database Setup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #f8f9fa; }
        .commotion-red { color: #b93a3a; }
        .bg-commotion-red { background-color: #b93a3a; }
    </style>
</head>
<body class="min-h-screen p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold commotion-red mb-2">COMMOTION.APP</h1>
        <h2 class="text-xl text-gray-600 mb-8">Database Setup & Seeding</h2>
        
        <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
            <h3 class="font-bold text-lg mb-4">Step 1: Create Test Users</h3>
            <p class="text-sm text-gray-600 mb-4">This will create 3 test users in Firebase Authentication with the password "demo123"</p>
            <button onclick="createUsers()" id="createUsersBtn" class="px-4 py-2 bg-commotion-red text-white rounded-lg font-semibold hover:opacity-90">
                Create Users
            </button>
            <div id="userStatus" class="mt-4 text-sm"></div>
        </div>

        <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
            <h3 class="font-bold text-lg mb-4">Step 2: Seed Database</h3>
            <p class="text-sm text-gray-600 mb-4">This will populate Firestore with demo events, crew, clients, gear, and tasks.</p>
            <button onclick="seedDatabase()" id="seedDbBtn" class="px-4 py-2 bg-commotion-red text-white rounded-lg font-semibold hover:opacity-90">
                Seed Database
            </button>
            <div id="seedStatus" class="mt-4 text-sm"></div>
        </div>

        <div class="bg-yellow-50 border border-yellow-200 rounded-xl shadow-sm p-6 mb-6">
            <h3 class="font-bold text-lg mb-4 text-yellow-800">⚠️ Reset Database</h3>
            <p class="text-sm text-yellow-700 mb-4">This will DELETE all existing data and reseed with fresh demo data. Use this if you want to start fresh.</p>
            <button onclick="clearAndReseed()" id="resetBtn" class="px-4 py-2 bg-yellow-600 text-white rounded-lg font-semibold hover:bg-yellow-700">
                Clear & Reseed All Data
            </button>
            <div id="resetStatus" class="mt-4 text-sm"></div>
        </div>

        <div class="bg-white rounded-xl shadow-sm p-6">
            <h3 class="font-bold text-lg mb-4">Status Log</h3>
            <div id="log" class="bg-gray-50 rounded-lg p-4 text-xs font-mono h-64 overflow-y-auto"></div>
        </div>
    </div>

    <script src="js/firebase-config.js"></script>
    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'text-red-600' : type === 'success' ? 'text-green-600' : 'text-gray-600';
            logDiv.innerHTML += `<div class="${color}">[${time}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // Test users to create
        const testUsers = [
            { email: 'jem@commotion.studio', role: 'admin', fullName: 'Jem Anderson-Gardner' },
            { email: 'ethan@rhythmandalps.co.nz', role: 'client', fullName: 'Ethan Walter', clientId: 'client-001' },
            { email: 'sam@crewmail.com', role: 'crew', fullName: 'Sam King', crewId: 'crew-sam' }
        ];

        async function createUsers() {
            const btn = document.getElementById('createUsersBtn');
            const status = document.getElementById('userStatus');
            btn.disabled = true;
            btn.textContent = 'Creating...';
            
            log('Starting user creation...');
            
            for (const user of testUsers) {
                try {
                    // Create user in Firebase Auth
                    const userCredential = await auth.createUserWithEmailAndPassword(user.email, 'demo123');
                    log(`Created auth user: ${user.email}`, 'success');
                    
                    // Create user profile in Firestore
                    const profileData = {
                        email: user.email,
                        role: user.role,
                        fullName: user.fullName,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    if (user.clientId) profileData.clientId = user.clientId;
                    if (user.crewId) profileData.crewId = user.crewId;
                    
                    await db.collection('users').doc(userCredential.user.uid).set(profileData);
                    log(`Created user profile for: ${user.fullName}`, 'success');
                    
                    // Sign out after creating each user
                    await auth.signOut();
                    
                } catch (error) {
                    if (error.code === 'auth/email-already-in-use') {
                        log(`User ${user.email} already exists - skipping`, 'info');
                    } else {
                        log(`Error creating ${user.email}: ${error.message}`, 'error');
                    }
                }
            }
            
            status.innerHTML = '<span class="text-green-600">✓ Users created successfully!</span>';
            btn.textContent = 'Done';
            log('User creation complete!', 'success');
        }

        async function seedDatabase() {
            const btn = document.getElementById('seedDbBtn');
            const status = document.getElementById('seedStatus');
            btn.disabled = true;
            btn.textContent = 'Seeding...';
            
            log('Starting database seeding...');
            
            try {
                // Seed Clients - 8 clients
                const clients = [
                    { id: 'client-001', company: 'Hidden Lakes Events Ltd', contact: 'Sarah Johnson', email: 'sarah@hiddenlakes.co.nz', phone: '+64 21 987 6543' },
                    { id: 'client-002', company: 'Festival One Productions', contact: 'Mark Williams', email: 'mark@festivalone.co.nz', phone: '+64 27 123 4567' },
                    { id: 'client-003', company: 'Electric Avenue Trust', contact: 'Emma Davis', email: 'emma@electricavenue.co.nz', phone: '+64 21 456 7890' },
                    { id: 'client-004', company: 'R&A Festival Ltd', contact: 'Tom Roberts', email: 'tom@rhythmandalps.co.nz', phone: '+64 27 789 0123' },
                    { id: 'client-005', company: 'Splore Festival Trust', contact: 'Lisa Chen', email: 'lisa@splore.co.nz', phone: '+64 21 234 5678' },
                    { id: 'client-006', company: 'ABA Events', contact: 'Jake Morrison', email: 'jake@northernbass.co.nz', phone: '+64 27 567 8901' },
                    { id: 'client-007', company: 'Bay Dreams Ltd', contact: 'Rachel Green', email: 'rachel@baydreams.co.nz', phone: '+64 21 678 9012' },
                    { id: 'client-008', company: 'Laneway Productions NZ', contact: 'David Kim', email: 'david@laneway.co.nz', phone: '+64 27 890 1234' }
                ];
                
                for (const client of clients) {
                    await db.collection('clients').doc(client.id).set(client);
                }
                log(`Seeded ${clients.length} clients`, 'success');

                // Seed Crew - 11 crew members
                const crew = [
                    { id: 'crew-001', name: 'Mike Thompson', role: 'Lead Videographer', skills: ['Camera Op', 'Directing', 'Gimbal'], rate: 450, phone: '+64 21 111 2222', email: 'mike@example.com', available: true },
                    { id: 'crew-002', name: 'Sarah Chen', role: 'Drone Operator', skills: ['Drone', 'Aerial', 'Part 102 Certified'], rate: 380, phone: '+64 27 222 3333', email: 'sarah@example.com', available: true },
                    { id: 'crew-003', name: 'James Wilson', role: 'Camera Operator', skills: ['Camera Op', '4K', 'Multi-cam'], rate: 350, phone: '+64 21 333 4444', email: 'james@example.com', available: false },
                    { id: 'crew-004', name: 'Emily Brown', role: 'Sound Recordist', skills: ['Audio', 'Field Recording', 'Mixing'], rate: 320, phone: '+64 27 444 5555', email: 'emily@example.com', available: true },
                    { id: 'crew-005', name: 'Tom Anderson', role: 'Gimbal Operator', skills: ['Gimbal', 'Stabilization', 'Tracking'], rate: 340, phone: '+64 21 555 6666', email: 'tom@example.com', available: true },
                    { id: 'crew-006', name: 'Lisa Martinez', role: 'Video Editor', skills: ['Premiere Pro', 'DaVinci', 'Color'], rate: 360, phone: '+64 27 666 7777', email: 'lisa@example.com', available: true },
                    { id: 'crew-007', name: 'David Kim', role: 'Colorist', skills: ['Color Grading', 'DaVinci', 'LUTs'], rate: 370, phone: '+64 21 777 8888', email: 'davidk@example.com', available: false },
                    { id: 'crew-008', name: 'Rachel Green', role: 'Production Assistant', skills: ['Logistics', 'Coordination', 'Admin'], rate: 280, phone: '+64 27 888 9999', email: 'rachel@example.com', available: true },
                    { id: 'crew-009', name: 'Chris Lee', role: 'Lighting Tech', skills: ['Lighting', 'Aputure', 'Setup'], rate: 310, phone: '+64 21 999 0000', email: 'chris@example.com', available: true },
                    { id: 'crew-010', name: 'Anna Taylor', role: 'Social Media Creator', skills: ['Content', 'Instagram', 'TikTok'], rate: 290, phone: '+64 27 000 1111', email: 'anna@example.com', available: true },
                    { id: 'crew-sam', name: 'Sam King', role: 'Camera Operator', skills: ['Camera Op', 'Gimbal', 'Run & Gun', 'Festival'], rate: 380, phone: '+64 21 555 0001', email: 'sam@commotionstudio.co.nz', available: true }
                ];
                
                for (const member of crew) {
                    await db.collection('crew').doc(member.id).set(member);
                }
                log(`Seeded ${crew.length} crew members`, 'success');

                // Seed Events - 8 events with full details
                const events = [
                    {
                        id: 'evt-001',
                        name: 'Hidden Lakes Festival 2025',
                        client_id: 'client-001',
                        clientName: 'Hidden Lakes Events Ltd',
                        startDate: '2025-02-14',
                        endDate: '2025-02-16',
                        location: 'Cooks Beach, Coromandel',
                        status: 'confirmed',
                        attendees: 5000,
                        quoteAmount: 12500,
                        paidAmount: 6250,
                        crewCount: 4,
                        crewAssigned: ['crew-001', 'crew-002', 'crew-005', 'crew-sam'],
                        gearValue: 45000,
                        deliverables: [
                            { id: 'del-001', type: 'Highlight Reel', duration: '3-5 min', dueDate: '2025-03-01', status: 'pending', progress: 0 },
                            { id: 'del-002', type: 'Full Coverage', duration: '45 min', dueDate: '2025-03-15', status: 'pending', progress: 0 },
                            { id: 'del-003', type: 'Social Media Clips', duration: '30-60 sec', dueDate: '2025-02-20', status: 'pending', progress: 0 }
                        ],
                        notes: 'Three-day boutique festival. Main stage coverage priority. VIP area requires special access passes.',
                        color: '#10b981',
                        schedule: [
                            { date: '2025-02-14', title: 'Day 1 - Setup & Soft Opening', items: [
                                { time: '08:00', activity: 'Crew arrival & gear setup', crew: ['crew-001', 'crew-sam'] },
                                { time: '10:00', activity: 'Site walkthrough with client', crew: ['crew-001'] },
                                { time: '14:00', activity: 'Sound check coverage', crew: ['crew-001', 'crew-005'] },
                                { time: '16:00', activity: 'Gates open - crowd arrivals', crew: ['crew-001', 'crew-sam', 'crew-005'] },
                                { time: '18:00', activity: 'Opening act - Main Stage', crew: ['crew-001', 'crew-005'] },
                                { time: '20:00', activity: 'Headliner Day 1', crew: ['crew-001', 'crew-sam', 'crew-002'] }
                            ]},
                            { date: '2025-02-15', title: 'Day 2 - Main Event Day', items: [
                                { time: '06:00', activity: 'Sunrise drone shots', crew: ['crew-002'] },
                                { time: '09:00', activity: 'Morning atmosphere & camping', crew: ['crew-sam'] },
                                { time: '12:00', activity: 'Afternoon sets begin', crew: ['crew-001', 'crew-005'] },
                                { time: '15:00', activity: 'VIP area coverage', crew: ['crew-sam'] },
                                { time: '18:00', activity: 'Golden hour drone aerials', crew: ['crew-002'] },
                                { time: '20:00', activity: 'Main headliner', crew: ['crew-001', 'crew-sam', 'crew-005', 'crew-002'] },
                                { time: '23:00', activity: 'Late night sets', crew: ['crew-001', 'crew-sam'] }
                            ]},
                            { date: '2025-02-16', title: 'Day 3 - Final Day & Packdown', items: [
                                { time: '08:00', activity: 'Morning recovery footage', crew: ['crew-sam'] },
                                { time: '12:00', activity: 'Final afternoon performances', crew: ['crew-001', 'crew-005'] },
                                { time: '16:00', activity: 'Closing ceremony', crew: ['crew-001', 'crew-sam', 'crew-002'] },
                                { time: '18:00', activity: 'Pack down & depart', crew: ['crew-001', 'crew-sam'] }
                            ]}
                        ]
                    },
                    {
                        id: 'evt-002',
                        name: 'Festival One 2025',
                        client_id: 'client-002',
                        clientName: 'Festival One Productions',
                        startDate: '2025-01-02',
                        endDate: '2025-01-04',
                        location: 'Tairua, Coromandel',
                        status: 'completed',
                        attendees: 3500,
                        quoteAmount: 9800,
                        paidAmount: 9800,
                        crewCount: 3,
                        crewAssigned: ['crew-001', 'crew-003', 'crew-006'],
                        gearValue: 32000,
                        deliverables: [
                            { id: 'del-004', type: 'Highlight Reel', duration: '4 min', dueDate: '2025-01-20', status: 'completed', progress: 100 },
                            { id: 'del-005', type: 'Social Media Package', duration: 'Various', dueDate: '2025-01-10', status: 'completed', progress: 100 }
                        ],
                        notes: 'Beach location. Electronic music focus. Excellent sunset shots on Day 2.',
                        color: '#6366f1',
                        schedule: []
                    },
                    {
                        id: 'evt-003',
                        name: 'Electric Avenue 2024',
                        client_id: 'client-003',
                        clientName: 'Electric Avenue Trust',
                        startDate: '2024-12-28',
                        endDate: '2024-12-30',
                        location: 'Christchurch',
                        status: 'in-progress',
                        attendees: 8000,
                        quoteAmount: 16500,
                        paidAmount: 8250,
                        crewCount: 5,
                        crewAssigned: ['crew-001', 'crew-002', 'crew-003', 'crew-006', 'crew-007'],
                        gearValue: 52000,
                        deliverables: [
                            { id: 'del-006', type: 'Highlight Reel', duration: '5 min', dueDate: '2025-01-15', status: 'in-progress', progress: 65 },
                            { id: 'del-007', type: 'Artist Spotlights', duration: '10x 2min', dueDate: '2025-01-20', status: 'in-progress', progress: 40 },
                            { id: 'del-008', type: 'After Movie', duration: '8-10 min', dueDate: '2025-01-30', status: 'pending', progress: 10 }
                        ],
                        notes: 'Large urban festival. Multiple stages. Drone footage approved for aerial shots.',
                        color: '#f59e0b',
                        schedule: []
                    },
                    {
                        id: 'evt-004',
                        name: 'Rhythm & Alps 2025',
                        client_id: 'client-004',
                        clientName: 'R&A Festival Ltd',
                        startDate: '2024-12-29',
                        endDate: '2025-01-01',
                        location: 'Cardrona Valley, Wanaka',
                        status: 'in-progress',
                        attendees: 10000,
                        quoteAmount: 20000,
                        paidAmount: 10000,
                        crewCount: 6,
                        crewAssigned: ['crew-001', 'crew-002', 'crew-004', 'crew-005', 'crew-sam', 'crew-008'],
                        gearValue: 68000,
                        deliverables: [
                            { id: 'del-009', type: 'Official After Movie', duration: '8 min', dueDate: '2025-01-20', status: 'in-progress', progress: 35 },
                            { id: 'del-010', type: 'Daily Highlights', duration: '4x 3min', dueDate: '2025-01-05', status: 'in-progress', progress: 75 },
                            { id: 'del-011', type: 'Sponsor Content', duration: 'Various', dueDate: '2025-01-10', status: 'pending', progress: 20 }
                        ],
                        notes: 'Premium festival in stunning alpine location. Weather-dependent drone shots. Camping coverage required.',
                        color: '#ec4899',
                        schedule: [
                            { date: '2024-12-29', title: 'Day 1 - NYE Eve', items: [
                                { time: '10:00', activity: 'Site setup & morning shots', crew: ['crew-001', 'crew-sam'] },
                                { time: '14:00', activity: 'Crowd arrivals', crew: ['crew-sam', 'crew-005'] },
                                { time: '18:00', activity: 'Sunset main stage', crew: ['crew-001', 'crew-002'] },
                                { time: '22:00', activity: 'Night performances', crew: ['crew-001', 'crew-sam', 'crew-004'] }
                            ]},
                            { date: '2024-12-30', title: 'Day 2', items: [
                                { time: '08:00', activity: 'Morning campsite coverage', crew: ['crew-sam'] },
                                { time: '12:00', activity: 'Day sessions', crew: ['crew-001', 'crew-005'] },
                                { time: '16:00', activity: 'Mountain backdrop drone shots', crew: ['crew-002'] },
                                { time: '20:00', activity: 'Evening headliners', crew: ['crew-001', 'crew-sam', 'crew-004'] }
                            ]},
                            { date: '2024-12-31', title: 'Day 3 - NYE', items: [
                                { time: '10:00', activity: 'NYE morning atmosphere', crew: ['crew-sam'] },
                                { time: '15:00', activity: 'Build up to midnight', crew: ['crew-001', 'crew-005'] },
                                { time: '23:30', activity: 'Countdown coverage', crew: ['crew-001', 'crew-sam', 'crew-002', 'crew-004'] },
                                { time: '00:00', activity: 'Midnight celebrations', crew: ['crew-001', 'crew-sam', 'crew-002'] }
                            ]},
                            { date: '2025-01-01', title: 'Day 4 - New Years Day', items: [
                                { time: '12:00', activity: 'Recovery day coverage', crew: ['crew-sam'] },
                                { time: '16:00', activity: 'Final performances', crew: ['crew-001', 'crew-005'] },
                                { time: '20:00', activity: 'Closing & pack down', crew: ['crew-001', 'crew-sam'] }
                            ]}
                        ]
                    },
                    {
                        id: 'evt-005',
                        name: 'Splore 2025',
                        client_id: 'client-005',
                        clientName: 'Splore Festival Trust',
                        startDate: '2025-02-21',
                        endDate: '2025-02-23',
                        location: 'Tapapakanga Regional Park, Auckland',
                        status: 'quote-sent',
                        attendees: 6000,
                        quoteAmount: 13200,
                        paidAmount: 0,
                        crewCount: 0,
                        crewAssigned: [],
                        gearValue: 0,
                        deliverables: [
                            { id: 'del-012', type: 'Festival Documentary', duration: '12-15 min', dueDate: '2025-03-15', status: 'pending', progress: 0 },
                            { id: 'del-013', type: 'Highlight Reel', duration: '4 min', dueDate: '2025-03-05', status: 'pending', progress: 0 }
                        ],
                        notes: 'Arts & music festival with unique coastal setting. Focus on creative installations and beach activities.',
                        color: '#8b5cf6',
                        schedule: []
                    },
                    {
                        id: 'evt-006',
                        name: 'Northern Bass 2025',
                        client_id: 'client-006',
                        clientName: 'ABA Events',
                        startDate: '2024-12-29',
                        endDate: '2025-01-01',
                        location: 'Mangawhai',
                        status: 'confirmed',
                        attendees: 7500,
                        quoteAmount: 15000,
                        paidAmount: 7500,
                        crewCount: 5,
                        crewAssigned: ['crew-003', 'crew-006', 'crew-009', 'crew-010', 'crew-sam'],
                        gearValue: 55000,
                        deliverables: [
                            { id: 'del-015', type: 'Festival Recap', duration: '6 min', dueDate: '2025-01-15', status: 'pending', progress: 0 },
                            { id: 'del-016', type: 'Artist Interviews', duration: '5x 3min', dueDate: '2025-01-12', status: 'pending', progress: 0 }
                        ],
                        notes: 'Bass music focused festival. Great atmosphere for crowd shots.',
                        color: '#06b6d4',
                        schedule: [
                            { date: '2024-12-29', title: 'Day 1', items: [
                                { time: '12:00', activity: 'Gates open coverage', crew: ['crew-003', 'crew-sam'] },
                                { time: '16:00', activity: 'Afternoon sets', crew: ['crew-003', 'crew-006'] },
                                { time: '20:00', activity: 'Evening performances', crew: ['crew-003', 'crew-sam', 'crew-010'] }
                            ]},
                            { date: '2024-12-30', title: 'Day 2', items: [
                                { time: '10:00', activity: 'Morning vibes', crew: ['crew-sam'] },
                                { time: '14:00', activity: 'Artist interviews', crew: ['crew-010'] },
                                { time: '18:00', activity: 'Sunset session', crew: ['crew-003', 'crew-006'] },
                                { time: '22:00', activity: 'Headliners', crew: ['crew-003', 'crew-sam', 'crew-009'] }
                            ]},
                            { date: '2024-12-31', title: 'Day 3 - NYE', items: [
                                { time: '14:00', activity: 'NYE build up', crew: ['crew-003', 'crew-sam'] },
                                { time: '23:00', activity: 'Countdown & fireworks', crew: ['crew-003', 'crew-sam', 'crew-009', 'crew-010'] }
                            ]},
                            { date: '2025-01-01', title: 'Day 4 - Final Day', items: [
                                { time: '12:00', activity: 'Final day atmosphere', crew: ['crew-sam'] },
                                { time: '18:00', activity: 'Closing set', crew: ['crew-003', 'crew-006'] }
                            ]}
                        ]
                    },
                    {
                        id: 'evt-007',
                        name: 'Bay Dreams Nelson 2025',
                        client_id: 'client-007',
                        clientName: 'Bay Dreams Ltd',
                        startDate: '2025-01-03',
                        endDate: '2025-01-04',
                        location: 'Trafalgar Park, Nelson',
                        status: 'lead',
                        attendees: 12000,
                        quoteAmount: 0,
                        paidAmount: 0,
                        crewCount: 0,
                        crewAssigned: [],
                        gearValue: 0,
                        deliverables: [],
                        notes: 'Initial inquiry. Major festival with big-name artists. Requires full production crew if confirmed.',
                        color: '#64748b',
                        schedule: []
                    },
                    {
                        id: 'evt-008',
                        name: 'Laneway Festival Auckland 2025',
                        client_id: 'client-008',
                        clientName: 'Laneway Productions NZ',
                        startDate: '2025-01-27',
                        endDate: '2025-01-27',
                        location: 'Silo Park, Auckland',
                        status: 'confirmed',
                        attendees: 9000,
                        quoteAmount: 11500,
                        paidAmount: 5750,
                        crewCount: 4,
                        crewAssigned: ['crew-001', 'crew-002', 'crew-sam', 'crew-010'],
                        gearValue: 42000,
                        deliverables: [
                            { id: 'del-017', type: 'Artist Performances', duration: '8x 3min', dueDate: '2025-02-05', status: 'pending', progress: 0 },
                            { id: 'del-018', type: 'Festival Highlights', duration: '5 min', dueDate: '2025-02-10', status: 'pending', progress: 0 }
                        ],
                        notes: 'One-day urban festival. Multiple stages in compact venue. Crowd safety priority.',
                        color: '#14b8a6',
                        schedule: [
                            { date: '2025-01-27', title: 'Single Day Event', items: [
                                { time: '10:00', activity: 'Setup & sound check', crew: ['crew-001', 'crew-sam'] },
                                { time: '12:00', activity: 'Gates open', crew: ['crew-001', 'crew-sam', 'crew-010'] },
                                { time: '14:00', activity: 'Early sets', crew: ['crew-sam', 'crew-010'] },
                                { time: '16:00', activity: 'Main stage coverage', crew: ['crew-001', 'crew-002'] },
                                { time: '18:00', activity: 'Golden hour drone', crew: ['crew-002'] },
                                { time: '20:00', activity: 'Headliner', crew: ['crew-001', 'crew-sam', 'crew-002'] },
                                { time: '22:00', activity: 'Closing & pack down', crew: ['crew-001', 'crew-sam'] }
                            ]}
                        ]
                    }
                ];
                
                for (const event of events) {
                    await db.collection('events').doc(event.id).set(event);
                }
                log(`Seeded ${events.length} events`, 'success');

                // Seed Gear - 19 items
                const gear = [
                    { id: 'gear-001', name: 'Sony FX6 Camera #1', category: 'Camera', value: 8500, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-002', name: 'Sony FX6 Camera #2', category: 'Camera', value: 8500, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-003', name: 'Sony FX6 Camera #3', category: 'Camera', value: 8500, status: 'in-use', assignedTo: 'evt-003', owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-004', name: 'DJI Ronin RS3 Pro #1', category: 'Gimbal', value: 1200, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-005', name: 'DJI Ronin RS3 Pro #2', category: 'Gimbal', value: 1200, status: 'in-use', assignedTo: 'evt-004', owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-006', name: 'DJI Mavic 3 Cine #1', category: 'Drone', value: 6500, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-007', name: 'DJI Mavic 3 Cine #2', category: 'Drone', value: 6500, status: 'in-use', assignedTo: 'evt-003', owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-008', name: 'Sony 24-70mm GM II', category: 'Lens', value: 2800, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-009', name: 'Sony 70-200mm GM II', category: 'Lens', value: 3500, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-010', name: 'Rode NTG5 Shotgun Mic', category: 'Audio', value: 800, status: 'in-use', assignedTo: 'evt-004', owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-011', name: 'Zoom F6 Field Recorder', category: 'Audio', value: 900, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-012', name: 'Aputure 600d Pro', category: 'Lighting', value: 1800, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-013', name: 'Atomos Ninja V', category: 'Monitor', value: 900, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-014', name: 'Manfrotto Tripod Kit', category: 'Support', value: 450, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-015', name: 'CFexpress Card 256GB x5', category: 'Storage', value: 1500, status: 'available', assignedTo: null, owner: 'Commotion Studio', ownerId: 'commotion' },
                    { id: 'gear-016', name: 'Sony A7S III', category: 'Camera', value: 5200, status: 'in-use', assignedTo: 'evt-004', owner: 'Sam King', ownerId: 'crew-sam' },
                    { id: 'gear-017', name: 'Sony 16-35mm GM', category: 'Lens', value: 2800, status: 'in-use', assignedTo: 'evt-004', owner: 'Sam King', ownerId: 'crew-sam' },
                    { id: 'gear-018', name: 'DJI RS3 Mini', category: 'Gimbal', value: 650, status: 'available', assignedTo: null, owner: 'Sam King', ownerId: 'crew-sam' },
                    { id: 'gear-019', name: 'Rode Wireless GO II', category: 'Audio', value: 450, status: 'available', assignedTo: null, owner: 'Sam King', ownerId: 'crew-sam' }
                ];
                
                for (const item of gear) {
                    await db.collection('gear').doc(item.id).set(item);
                }
                log(`Seeded ${gear.length} gear items`, 'success');

                // Seed Tasks - 14 tasks
                const tasks = [
                    { id: 'task-001', eventId: 'evt-001', title: 'Site recce at Cooks Beach', assignedTo: 'crew-001', dueDate: '2025-02-10', status: 'done', priority: 'high' },
                    { id: 'task-002', eventId: 'evt-001', title: 'Confirm stage access passes', assignedTo: 'crew-008', dueDate: '2025-02-12', status: 'done', priority: 'high' },
                    { id: 'task-003', eventId: 'evt-001', title: 'Test drone flight permissions', assignedTo: 'crew-002', dueDate: '2025-02-13', status: 'in-progress', priority: 'medium' },
                    { id: 'task-004', eventId: 'evt-001', title: 'Prepare camera packages', assignedTo: 'crew-sam', dueDate: '2025-02-13', status: 'todo', priority: 'medium' },
                    { id: 'task-005', eventId: 'evt-003', title: 'Review stage layouts', assignedTo: 'crew-001', dueDate: '2025-01-05', status: 'in-progress', priority: 'high' },
                    { id: 'task-006', eventId: 'evt-003', title: 'Edit Day 1 highlights', assignedTo: 'crew-006', dueDate: '2025-01-08', status: 'in-progress', priority: 'urgent' },
                    { id: 'task-007', eventId: 'evt-004', title: 'Color grade main footage', assignedTo: 'crew-007', dueDate: '2025-01-10', status: 'in-progress', priority: 'high' },
                    { id: 'task-008', eventId: 'evt-004', title: 'Compile sponsor segments', assignedTo: 'crew-006', dueDate: '2025-01-09', status: 'todo', priority: 'medium' },
                    { id: 'task-009', eventId: 'evt-004', title: 'Capture campsite atmosphere B-roll', assignedTo: 'crew-sam', dueDate: '2024-12-30', status: 'done', priority: 'medium' },
                    { id: 'task-010', eventId: 'evt-004', title: 'NYE countdown filming positions', assignedTo: 'crew-sam', dueDate: '2024-12-31', status: 'done', priority: 'high' },
                    { id: 'task-011', eventId: 'evt-006', title: 'Bass stage coverage', assignedTo: 'crew-sam', dueDate: '2024-12-30', status: 'in-progress', priority: 'high' },
                    { id: 'task-012', eventId: 'evt-006', title: 'Crowd reaction shots', assignedTo: 'crew-sam', dueDate: '2024-12-31', status: 'todo', priority: 'medium' },
                    { id: 'task-013', eventId: 'evt-008', title: 'Scout Silo Park venue', assignedTo: 'crew-sam', dueDate: '2025-01-20', status: 'todo', priority: 'medium' },
                    { id: 'task-014', eventId: 'evt-001', title: 'VIP area setup shots', assignedTo: 'crew-sam', dueDate: '2025-02-14', status: 'todo', priority: 'low' }
                ];
                
                for (const task of tasks) {
                    await db.collection('tasks').doc(task.id).set(task);
                }
                log(`Seeded ${tasks.length} tasks`, 'success');

                status.innerHTML = '<span class="text-green-600">✓ Database seeded successfully!</span>';
                btn.textContent = 'Done';
                log('Database seeding complete!', 'success');
                log('Summary: 8 clients, 11 crew, 8 events, 19 gear items, 14 tasks', 'info');
                
            } catch (error) {
                log(`Error seeding database: ${error.message}`, 'error');
                status.innerHTML = '<span class="text-red-600">✗ Error - check log</span>';
                btn.textContent = 'Retry';
                btn.disabled = false;
            }
        }

        async function clearAndReseed() {
            if (!confirm('This will DELETE all existing data and replace it with fresh demo data. Are you sure?')) {
                return;
            }
            
            const btn = document.getElementById('resetBtn');
            const status = document.getElementById('resetStatus');
            btn.disabled = true;
            btn.textContent = 'Clearing...';
            
            log('Starting database reset...', 'info');
            
            try {
                // Clear all collections
                const collections = ['events', 'crew', 'gear', 'clients', 'tasks'];
                
                for (const collectionName of collections) {
                    const snapshot = await db.collection(collectionName).get();
                    const batch = db.batch();
                    snapshot.docs.forEach(doc => batch.delete(doc.ref));
                    await batch.commit();
                    log(`Cleared ${snapshot.size} documents from ${collectionName}`, 'success');
                }
                
                btn.textContent = 'Reseeding...';
                log('All collections cleared. Starting reseed...', 'info');
                
                // Now seed fresh data
                await seedDatabase();
                
                status.innerHTML = '<span class="text-green-600">✓ Database reset and reseeded!</span>';
                btn.textContent = 'Done';
                
            } catch (error) {
                log(`Error resetting database: ${error.message}`, 'error');
                status.innerHTML = '<span class="text-red-600">✗ Error - check log</span>';
                btn.textContent = 'Retry';
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
